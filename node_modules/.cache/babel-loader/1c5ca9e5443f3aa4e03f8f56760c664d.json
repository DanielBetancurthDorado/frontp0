{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/Users/danielbetancurth/Desktop/proyecto0cloud/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/danielbetancurth/Desktop/proyecto0cloud/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/danielbetancurth/Desktop/proyecto0cloud/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import axios from\"axios\";import{Redirect}from\"react-router\";import{useContext}from\"react\";import{Context}from\"../hooks/context.js\";import{useHistory}from\"react-router-dom\";import{Button}from\"react-bootstrap\";var Login=function Login(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var _useContext=useContext(Context),_useContext2=_slicedToArray(_useContext,2),context=_useContext2[0],setContext=_useContext2[1];var history=useHistory();var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var response,token,usuarioActualizarToken,idActualizar,actualizacionToken;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.next=3;return axios.post(\"/auth\",{username:username,password:password});case 3:response=_context.sent;token=\"JWT \".concat(response.data.access_token);//'/usuarios/<str:login>/<str:password>'\n_context.next=7;return axios.get(\"/usuarios/\".concat(username,\"/\").concat(password));case 7:usuarioActualizarToken=_context.sent;idActualizar=usuarioActualizarToken.data.id;_context.next=11;return axios.put(\"/usuarios/\"+idActualizar,{login:username,contrasena:password,token:token});case 11:actualizacionToken=_context.sent;setContext(actualizacionToken.data);setUser(actualizacionToken.data);case 14:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();// if there's a user show the message below\nif(user){var path=\"/usuarios/\".concat(user.id,\"/eventos\");return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Redirect,{to:path})});}var irRegistro=function irRegistro(){history.push(\"/\");};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Inicia sesi\\xF3n\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Correo: \"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:username,placeholder:\"Ingresa un correo\",onChange:function onChange(_ref2){var target=_ref2.target;return setUsername(target.value);}}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Contrase\\xF1a: \"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,placeholder:\"Ingresa una contrase\\xF1a\",onChange:function onChange(_ref3){var target=_ref3.target;return setPassword(target.value);}})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",children:\"Enviar\"}),/*#__PURE__*/_jsx(Button,{onClick:irRegistro,children:\"Ir a registro\"})]})]});};export default Login;","map":{"version":3,"sources":["/Users/danielbetancurth/Desktop/proyecto0cloud/src/components/login.js"],"names":["React","useState","axios","Redirect","useContext","Context","useHistory","Button","Login","username","setUsername","password","setPassword","user","setUser","context","setContext","history","handleSubmit","e","preventDefault","post","response","token","data","access_token","get","usuarioActualizarToken","idActualizar","id","put","login","contrasena","actualizacionToken","path","irRegistro","push","target","value"],"mappings":"okBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,QAAT,KAAyB,cAAzB,CACA,OAASC,UAAT,KAA2B,OAA3B,CACA,OAASC,OAAT,KAAwB,qBAAxB,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,MAAT,KAAuB,iBAAvB,CAEA,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,EAAM,eACcP,QAAQ,CAAC,EAAD,CADtB,wCACXQ,QADW,eACDC,WADC,8BAEcT,QAAQ,CAAC,EAAD,CAFtB,yCAEXU,QAFW,eAEDC,WAFC,8BAGMX,QAAQ,EAHd,yCAGXY,IAHW,eAGLC,OAHK,+BAIYV,UAAU,CAACC,OAAD,CAJtB,4CAIXU,OAJW,iBAIFC,UAJE,iBAKlB,GAAMC,CAAAA,OAAO,CAAGX,UAAU,EAA1B,CAEA,GAAMY,CAAAA,YAAY,0FAAG,iBAAOC,CAAP,4LACnBA,CAAC,CAACC,cAAF,GADmB,sBAEIlB,CAAAA,KAAK,CAACmB,IAAN,CAAW,OAAX,CAAoB,CACzCZ,QAAQ,CAAEA,QAD+B,CAEzCE,QAAQ,CAAEA,QAF+B,CAApB,CAFJ,QAEbW,QAFa,eAMbC,KANa,eAMED,QAAQ,CAACE,IAAT,CAAcC,YANhB,EAOnB;AAPmB,sBAQkBvB,CAAAA,KAAK,CAACwB,GAAN,qBACtBjB,QADsB,aACVE,QADU,EARlB,QAQbgB,sBARa,eAWbC,YAXa,CAWED,sBAAsB,CAACH,IAAvB,CAA4BK,EAX9B,wBAYc3B,CAAAA,KAAK,CAAC4B,GAAN,CAAU,aAAeF,YAAzB,CAAuC,CACtEG,KAAK,CAAEtB,QAD+D,CAEtEuB,UAAU,CAAErB,QAF0D,CAGtEY,KAAK,CAAEA,KAH+D,CAAvC,CAZd,SAYbU,kBAZa,eAiBnBjB,UAAU,CAACiB,kBAAkB,CAACT,IAApB,CAAV,CACAV,OAAO,CAACmB,kBAAkB,CAACT,IAApB,CAAP,CAlBmB,uDAAH,kBAAZN,CAAAA,YAAY,4CAAlB,CAoBA;AACA,GAAIL,IAAJ,CAAU,CACR,GAAMqB,CAAAA,IAAI,qBAAgBrB,IAAI,CAACgB,EAArB,YAAV,CACA,mBACE,kCACE,KAAC,QAAD,EAAU,EAAE,CAAEK,IAAd,EADF,EADF,CAKD,CACD,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvBlB,OAAO,CAACmB,IAAR,CAAa,GAAb,EACD,CAFD,CAGA,mBACE,oCACE,wCADF,cAEE,cAAM,QAAQ,CAAElB,YAAhB,wBACE,cAAO,OAAO,CAAC,UAAf,sBADF,cAEE,cACE,IAAI,CAAC,OADP,CAEE,KAAK,CAAET,QAFT,CAGE,WAAW,CAAC,mBAHd,CAIE,QAAQ,CAAE,4BAAG4B,CAAAA,MAAH,OAAGA,MAAH,OAAgB3B,CAAAA,WAAW,CAAC2B,MAAM,CAACC,KAAR,CAA3B,EAJZ,EAFF,cAQE,oCACE,cAAO,OAAO,CAAC,UAAf,6BADF,cAEE,cACE,IAAI,CAAC,UADP,CAEE,KAAK,CAAE3B,QAFT,CAGE,WAAW,CAAC,2BAHd,CAIE,QAAQ,CAAE,4BAAG0B,CAAAA,MAAH,OAAGA,MAAH,OAAgBzB,CAAAA,WAAW,CAACyB,MAAM,CAACC,KAAR,CAA3B,EAJZ,EAFF,GARF,cAiBE,KAAC,MAAD,EAAQ,IAAI,CAAC,QAAb,oBAjBF,cAkBE,KAAC,MAAD,EAAQ,OAAO,CAAEH,UAAjB,2BAlBF,GAFF,GADF,CAyBD,CAhED,CAiEA,cAAe3B,CAAAA,KAAf","sourcesContent":["import React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { Redirect } from \"react-router\";\nimport { useContext } from \"react\";\nimport { Context } from \"../hooks/context.js\";\nimport { useHistory } from \"react-router-dom\";\nimport { Button } from \"react-bootstrap\";\n\nconst Login = () => {\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [user, setUser] = useState();\n  const [context, setContext] = useContext(Context);\n  const history = useHistory();\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    const response = await axios.post(\"/auth\", {\n      username: username,\n      password: password,\n    });\n    const token = `JWT ${response.data.access_token}`;\n    //'/usuarios/<str:login>/<str:password>'\n    const usuarioActualizarToken = await axios.get(\n      `/usuarios/${username}/${password}`\n    );\n    const idActualizar = usuarioActualizarToken.data.id;\n    const actualizacionToken = await axios.put(\"/usuarios/\" + idActualizar, {\n      login: username,\n      contrasena: password,\n      token: token,\n    });\n    setContext(actualizacionToken.data);\n    setUser(actualizacionToken.data);\n  };\n  // if there's a user show the message below\n  if (user) {\n    const path = `/usuarios/${user.id}/eventos`;\n    return (\n      <div>\n        <Redirect to={path} />\n      </div>\n    );\n  }\n  const irRegistro = () => {\n    history.push(\"/\");\n  };\n  return (\n    <div>\n      <h1>Inicia sesión</h1>\n      <form onSubmit={handleSubmit}>\n        <label htmlFor=\"username\">Correo: </label>\n        <input\n          type=\"email\"\n          value={username}\n          placeholder=\"Ingresa un correo\"\n          onChange={({ target }) => setUsername(target.value)}\n        />\n        <div>\n          <label htmlFor=\"password\">Contraseña: </label>\n          <input\n            type=\"password\"\n            value={password}\n            placeholder=\"Ingresa una contraseña\"\n            onChange={({ target }) => setPassword(target.value)}\n          />\n        </div>\n        <Button type=\"submit\">Enviar</Button>\n        <Button onClick={irRegistro}>Ir a registro</Button>\n      </form>\n    </div>\n  );\n};\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}